<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="relacionCoreHiloTejido" language="groovy" pageWidth="612" pageHeight="792" columnWidth="588" leftMargin="12" rightMargin="12" topMargin="12" bottomMargin="12" uuid="940b7624-42a9-4970-8b76-59c4ab579c3b">
	<property name="ireport.zoom" value="2.968683328607428"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<style name="Title" forecolor="#FFFFFF" fontName="Arial" fontSize="26" isBold="true" pdfFontName="Helvetica-Bold"/>
	<style name="SubTitle" forecolor="#666666" fontName="Arial" fontSize="18"/>
	<style name="Column header" forecolor="#666666" fontName="Arial" fontSize="12" isBold="true"/>
	<style name="Detail" fontName="Arial" fontSize="12"/>
	<parameter name="logo" class="java.lang.String"/>
	<parameter name="empresa" class="java.lang.String"/>
	<parameter name="estilo" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT
L.`Clave` as numlinea,
L.`Descripcion` as nomlinea,
D.`Clave` as numdepto,
D.`Descripcion` as nomdepto,
S.`Clave` as numfrac,
S.`Descripcion` as nomfrac,
SUM(SFE.`costo`) AS costo
FROM subfraccionesxestilo SFE
JOIN estilos E ON E.`Clave` = SFE.`estilo`
JOIN lineas L ON E.`Linea` = L.`Clave`
JOIN fracciones S ON S.`Clave` = SFE.`fraccion`
JOIN departamentos D ON S.`Departamento` = D.`Clave`
WHERE SFE.`estilo` = $P{estilo}
AND S.`AfectaCostoVTA` = 1
GROUP BY D.`Clave`, S.`Clave`
ORDER BY ABS(D.`Clave`) , ABS(S.`Clave`) ASC]]>
	</queryString>
	<field name="numlinea" class="java.lang.String"/>
	<field name="nomlinea" class="java.lang.String"/>
	<field name="numdepto" class="java.lang.String"/>
	<field name="nomdepto" class="java.lang.String"/>
	<field name="numfrac" class="java.lang.String"/>
	<field name="nomfrac" class="java.lang.String"/>
	<field name="costo" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<variable name="costo_1" class="java.math.BigDecimal" resetType="Group" resetGroup="Depto" calculation="Sum">
		<variableExpression><![CDATA[$F{costo}]]></variableExpression>
	</variable>
	<variable name="costo_2" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{costo}]]></variableExpression>
	</variable>
	<group name="Depto">
		<groupExpression><![CDATA[$F{numdepto}]]></groupExpression>
		<groupHeader>
			<band height="14"/>
		</groupHeader>
		<groupFooter>
			<band height="13">
				<staticText>
					<reportElement style="Column header" x="385" y="0" width="111" height="12" forecolor="#000000" uuid="9112b1f6-882d-4b18-b1e0-a5f610e3e3c5"/>
					<textElement verticalAlignment="Middle">
						<font fontName="SansSerif" size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Total por departamento:]]></text>
				</staticText>
				<textField pattern="¤#,##0.00" isBlankWhenNull="false">
					<reportElement mode="Transparent" x="513" y="0" width="56" height="12" forecolor="#000000" backcolor="#FFFFFF" uuid="a3459d84-f9af-4e1f-a479-6c51cc8c8d57"/>
					<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" markup="none">
						<font fontName="SansSerif" size="8" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{costo_1}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band height="56" splitType="Stretch">
			<line>
				<reportElement style="Title" positionType="FixRelativeToBottom" x="0" y="55" width="588" height="1" uuid="54f5e41a-81ad-4684-8fc1-fe3bd8cb3d8a"/>
				<graphicElement>
					<pen lineWidth="1.0" lineColor="#000000"/>
				</graphicElement>
			</line>
			<staticText>
				<reportElement style="Column header" x="1" y="44" width="45" height="11" forecolor="#000000" uuid="e060d432-48d9-48a1-8673-13aae0d018bc"/>
				<textElement verticalAlignment="Middle">
					<font fontName="SansSerif" size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Empleado]]></text>
			</staticText>
			<textField>
				<reportElement x="491" y="0" width="80" height="12" uuid="6b713664-7e14-470b-817e-114b62f12fc2"/>
				<textElement textAlignment="Right">
					<font fontName="SansSerif" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA["Pag. "+$V{PAGE_NUMBER}+" de"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="572" y="0" width="15" height="12" uuid="bb3d53dd-52de-441b-8f18-2279ef0c01e7"/>
				<textElement textAlignment="Left">
					<font fontName="SansSerif" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField pattern="EEE, d MMM yyyy HH:mm:ss">
				<reportElement x="448" y="12" width="139" height="12" uuid="e1425944-7e58-40bd-8d33-418fa9ddc808"/>
				<textElement textAlignment="Right">
					<font fontName="SansSerif" size="9" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<image>
				<reportElement x="0" y="0" width="72" height="42" uuid="badb8959-f8da-4109-a197-4fe402e5e4a3"/>
				<imageExpression><![CDATA[$P{logo}]]></imageExpression>
			</image>
			<textField>
				<reportElement x="77" y="-2" width="159" height="14" uuid="68fc90ba-2f75-4f0d-b92d-9142efaf6ecc"/>
				<textElement>
					<font fontName="SansSerif" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{empresa}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement style="Column header" x="77" y="10" width="114" height="14" forecolor="#000000" uuid="fe0dcb59-670e-41bc-8ce4-9fe8d186d05f"/>
				<textElement verticalAlignment="Middle">
					<font fontName="SansSerif" size="9" isBold="true"/>
				</textElement>
				<text><![CDATA[Subfracciones del Estilo:]]></text>
			</staticText>
			<staticText>
				<reportElement style="Column header" x="513" y="44" width="57" height="11" forecolor="#000000" uuid="37b7b08d-3077-4086-9564-38f36b13aef1"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="SansSerif" size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Subtotal]]></text>
			</staticText>
			<textField>
				<reportElement x="191" y="10" width="40" height="14" uuid="48c2220c-099e-4592-b439-0bcd31c060ce"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{estilo}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement style="Column header" x="276" y="44" width="34" height="11" forecolor="#000000" uuid="5e527c3d-cffc-487f-80db-0103e27ba7fb"/>
				<textElement verticalAlignment="Middle">
					<font fontName="SansSerif" size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Fracción]]></text>
			</staticText>
			<staticText>
				<reportElement style="Column header" mode="Transparent" x="270" y="11" width="34" height="13" forecolor="#000000" backcolor="#FFFFFF" uuid="834a2505-3994-4253-a67d-dd0c7267f6a7"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="SansSerif" size="9" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[Linea:]]></text>
			</staticText>
			<textField>
				<reportElement x="304" y="11" width="134" height="13" uuid="659287f9-2f48-4c2b-9afb-168d545a7c34"/>
				<textElement verticalAlignment="Middle">
					<font size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{numlinea}+'  '+$F{nomlinea}]]></textFieldExpression>
			</textField>
		</band>
	</columnHeader>
	<detail>
		<band height="11" splitType="Stretch">
			<line>
				<reportElement positionType="FixRelativeToBottom" x="279" y="10" width="309" height="1" uuid="9c27175e-eeaf-4784-a04e-2bdb9e6f6f58"/>
				<graphicElement>
					<pen lineWidth="0.5" lineColor="#999999"/>
				</graphicElement>
			</line>
			<textField>
				<reportElement isPrintRepeatedValues="false" x="30" y="0" width="183" height="11" isPrintInFirstWholeBand="true" uuid="700ced94-6cdf-46fc-8dcb-407eed2ce999"/>
				<textElement>
					<font size="8" isBold="true" isItalic="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nomdepto}]]></textFieldExpression>
			</textField>
			<textField pattern="¤#,##0.00">
				<reportElement x="513" y="0" width="56" height="11" uuid="0b9cf1d6-174f-4703-be5c-0fd550562dad"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{costo}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement isPrintRepeatedValues="false" x="0" y="0" width="27" height="11" isPrintInFirstWholeBand="true" uuid="a4840844-9bcf-4d79-874c-2261fdc3baf2"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="true" isItalic="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{numdepto}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement isPrintRepeatedValues="false" x="279" y="0" width="25" height="11" isPrintInFirstWholeBand="true" uuid="1a2f8f3e-03ea-485e-8757-195df81b0bb4"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{numfrac}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement isPrintRepeatedValues="false" x="310" y="0" width="186" height="11" isPrintInFirstWholeBand="true" uuid="8f0cf93b-a04f-4563-af42-a25e4b15f5a3"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nomfrac}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<summary>
		<band height="14" splitType="Stretch">
			<staticText>
				<reportElement style="Column header" x="385" y="1" width="111" height="12" forecolor="#000000" uuid="bf4b6b79-8bad-420e-a7ba-97568b08664a"/>
				<textElement verticalAlignment="Middle">
					<font fontName="SansSerif" size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Total general:]]></text>
			</staticText>
			<line>
				<reportElement x="385" y="0" width="201" height="1" uuid="277bb294-e74f-4298-8ce3-f97c247295db"/>
			</line>
			<textField pattern="¤#,##0.00" isBlankWhenNull="false">
				<reportElement mode="Transparent" x="513" y="0" width="56" height="13" forecolor="#000000" backcolor="#FFFFFF" uuid="8056f946-25c6-4a2f-a245-8a0434a35afd"/>
				<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="SansSerif" size="8" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{costo_2}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>

<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="relacionCoreHiloTejido" language="groovy" pageWidth="612" pageHeight="792" columnWidth="588" leftMargin="12" rightMargin="12" topMargin="12" bottomMargin="12" uuid="940b7624-42a9-4970-8b76-59c4ab579c3b">
	<property name="ireport.zoom" value="1.8433187801425859"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<style name="Title" forecolor="#FFFFFF" fontName="Arial" fontSize="26" isBold="true" pdfFontName="Helvetica-Bold"/>
	<style name="SubTitle" forecolor="#666666" fontName="Arial" fontSize="18"/>
	<style name="Column header" forecolor="#666666" fontName="Arial" fontSize="12" isBold="true"/>
	<style name="Detail" fontName="Arial" fontSize="12"/>
	<parameter name="logo" class="java.lang.String"/>
	<parameter name="empresa" class="java.lang.String"/>
	<parameter name="sem" class="java.lang.String"/>
	<parameter name="ano" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT CAST(d.clave AS SIGNED) AS numdepto, d.descripcion AS nomdepto,
c.numemp, c.nomemp, COUNT(c.numemp) AS cantidad , SUM(c.cantida) AS importe
FROM comida c
JOIN empleados e ON e.numero = c.numemp
JOIN departamentos d ON e.departamentofisico  = d.clave
WHERE c.año = $P{ano} AND c.sem = $P{sem}
GROUP BY c.numemp
ORDER BY numdepto, ABS(c.nomemp) ASC]]>
	</queryString>
	<field name="numdepto" class="java.lang.Long">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nomdepto" class="java.lang.String"/>
	<field name="numemp" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nomemp" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="cantidad" class="java.lang.Long">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="importe" class="java.lang.Double">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<variable name="cantidad_1" class="java.lang.Long" resetType="Group" resetGroup="depto" calculation="Sum">
		<variableExpression><![CDATA[$F{cantidad}]]></variableExpression>
	</variable>
	<variable name="cantidad_2" class="java.lang.Long" calculation="Sum">
		<variableExpression><![CDATA[$F{cantidad}]]></variableExpression>
	</variable>
	<variable name="importe_1" class="java.lang.Double" resetType="Group" resetGroup="depto" calculation="Sum">
		<variableExpression><![CDATA[$F{importe}]]></variableExpression>
	</variable>
	<variable name="importe_2" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{importe}]]></variableExpression>
	</variable>
	<group name="depto" isReprintHeaderOnEachPage="true">
		<groupExpression><![CDATA[$F{numdepto}]]></groupExpression>
		<groupHeader>
			<band height="11">
				<textField>
					<reportElement isPrintRepeatedValues="false" x="0" y="0" width="27" height="11" isPrintInFirstWholeBand="true" uuid="bc74b258-74ec-48e2-bddb-3acb29927d41"/>
					<box>
						<bottomPen lineWidth="1.0"/>
					</box>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
						<paragraph rightIndent="3"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{numdepto}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement isPrintRepeatedValues="false" x="27" y="0" width="164" height="11" isPrintInFirstWholeBand="true" uuid="4332160f-51f9-42c3-bcf6-e83514283f26"/>
					<box>
						<bottomPen lineWidth="1.0"/>
					</box>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{nomdepto}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="13">
				<textField>
					<reportElement mode="Transparent" x="385" y="0" width="111" height="12" isPrintInFirstWholeBand="true" forecolor="#000000" backcolor="#FFFFFF" uuid="afb435eb-d0ce-4e17-85d6-7c790e8cf529"/>
					<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
						<font fontName="SansSerif" size="8" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA["Total por departamento"]]></textFieldExpression>
				</textField>
				<textField pattern="###0" isBlankWhenNull="false">
					<reportElement mode="Transparent" x="496" y="0" width="34" height="12" forecolor="#000000" backcolor="#FFFFFF" uuid="9858fe05-1c60-4ce9-b51d-5e76553cbca3"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
						<font fontName="SansSerif" size="8" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{cantidad_1}]]></textFieldExpression>
				</textField>
				<textField pattern="¤#,##0.00" isBlankWhenNull="false">
					<reportElement mode="Transparent" x="530" y="0" width="56" height="12" forecolor="#000000" backcolor="#FFFFFF" uuid="2ac098a1-eb61-4f54-a631-e7424c9d22e4"/>
					<textElement textAlignment="Right" verticalAlignment="Middle" rotation="None" markup="none">
						<font fontName="SansSerif" size="8" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{importe_1}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band height="56" splitType="Stretch">
			<line>
				<reportElement style="Title" positionType="FixRelativeToBottom" x="0" y="55" width="588" height="1" uuid="54f5e41a-81ad-4684-8fc1-fe3bd8cb3d8a"/>
				<graphicElement>
					<pen lineWidth="1.0" lineColor="#000000"/>
				</graphicElement>
			</line>
			<staticText>
				<reportElement style="Column header" x="1" y="44" width="61" height="11" forecolor="#000000" uuid="e060d432-48d9-48a1-8673-13aae0d018bc"/>
				<textElement verticalAlignment="Middle">
					<font fontName="SansSerif" size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Departamento]]></text>
			</staticText>
			<textField>
				<reportElement x="491" y="0" width="80" height="12" uuid="6b713664-7e14-470b-817e-114b62f12fc2"/>
				<textElement textAlignment="Right">
					<font fontName="SansSerif" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA["Pag. "+$V{PAGE_NUMBER}+" de"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="572" y="0" width="15" height="12" uuid="bb3d53dd-52de-441b-8f18-2279ef0c01e7"/>
				<textElement textAlignment="Left">
					<font fontName="SansSerif" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField pattern="EEE, d MMM yyyy HH:mm:ss">
				<reportElement x="448" y="12" width="139" height="12" uuid="e1425944-7e58-40bd-8d33-418fa9ddc808"/>
				<textElement textAlignment="Right">
					<font fontName="SansSerif" size="9" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<image>
				<reportElement x="0" y="0" width="72" height="42" uuid="badb8959-f8da-4109-a197-4fe402e5e4a3"/>
				<imageExpression><![CDATA[$P{logo}]]></imageExpression>
			</image>
			<textField>
				<reportElement x="77" y="-2" width="159" height="14" uuid="68fc90ba-2f75-4f0d-b92d-9142efaf6ecc"/>
				<textElement>
					<font fontName="SansSerif" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{empresa}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement style="Column header" x="77" y="10" width="158" height="14" forecolor="#000000" uuid="fe0dcb59-670e-41bc-8ce4-9fe8d186d05f"/>
				<textElement verticalAlignment="Middle">
					<font fontName="SansSerif" size="9" isBold="true"/>
				</textElement>
				<text><![CDATA[Reporte de comidas de la semana:]]></text>
			</staticText>
			<staticText>
				<reportElement style="Column header" x="263" y="10" width="21" height="14" forecolor="#000000" uuid="241f50af-a10a-45b4-aaec-9ba6f37d9786"/>
				<textElement verticalAlignment="Middle">
					<font fontName="SansSerif" size="9" isBold="true"/>
				</textElement>
				<text><![CDATA[Año:]]></text>
			</staticText>
			<staticText>
				<reportElement style="Column header" x="530" y="44" width="56" height="11" forecolor="#000000" uuid="37b7b08d-3077-4086-9564-38f36b13aef1"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="SansSerif" size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Importe]]></text>
			</staticText>
			<textField>
				<reportElement x="236" y="10" width="24" height="14" uuid="af01c898-11bc-4d2f-b001-c13e4e5f8653"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{sem}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="284" y="10" width="40" height="14" uuid="48c2220c-099e-4592-b439-0bcd31c060ce"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{ano}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement style="Column header" x="496" y="44" width="34" height="11" forecolor="#000000" uuid="d2a006b7-15bb-4e50-a2e2-44d31a18e14d"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="SansSerif" size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Comidas]]></text>
			</staticText>
			<staticText>
				<reportElement style="Column header" x="214" y="44" width="45" height="11" forecolor="#000000" uuid="b47811c9-892d-41bc-8b82-9c86ab02af8c"/>
				<textElement verticalAlignment="Middle">
					<font fontName="SansSerif" size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Empleado]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="11" splitType="Stretch">
			<line>
				<reportElement positionType="FixRelativeToBottom" x="213" y="10" width="375" height="1" uuid="9c27175e-eeaf-4784-a04e-2bdb9e6f6f58"/>
				<graphicElement>
					<pen lineWidth="0.5" lineColor="#999999"/>
				</graphicElement>
			</line>
			<textField>
				<reportElement isPrintRepeatedValues="false" x="244" y="0" width="186" height="11" isPrintInFirstWholeBand="true" uuid="700ced94-6cdf-46fc-8dcb-407eed2ce999"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nomemp}]]></textFieldExpression>
			</textField>
			<textField pattern="¤#,##0.00">
				<reportElement x="530" y="0" width="56" height="11" uuid="0b9cf1d6-174f-4703-be5c-0fd550562dad"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{importe}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement isPrintRepeatedValues="false" x="214" y="0" width="27" height="11" isPrintInFirstWholeBand="true" uuid="a4840844-9bcf-4d79-874c-2261fdc3baf2"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{numemp}]]></textFieldExpression>
			</textField>
			<textField pattern="###0">
				<reportElement x="496" y="0" width="34" height="11" uuid="c1dbe661-a590-4383-bd3b-98311c120202"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{cantidad}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<summary>
		<band height="14" splitType="Stretch">
			<staticText>
				<reportElement style="Column header" x="385" y="1" width="111" height="12" forecolor="#000000" uuid="bf4b6b79-8bad-420e-a7ba-97568b08664a"/>
				<textElement verticalAlignment="Middle">
					<font fontName="SansSerif" size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Total general:]]></text>
			</staticText>
			<line>
				<reportElement x="385" y="0" width="201" height="1" uuid="277bb294-e74f-4298-8ce3-f97c247295db"/>
			</line>
			<textField pattern="###0" isBlankWhenNull="false">
				<reportElement mode="Transparent" x="496" y="1" width="34" height="12" forecolor="#000000" backcolor="#FFFFFF" uuid="441a164b-731a-4cc3-a85b-b4b6b58210e7"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="SansSerif" size="8" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{cantidad_2}]]></textFieldExpression>
			</textField>
			<textField pattern="¤#,##0.00" isBlankWhenNull="false">
				<reportElement mode="Transparent" x="530" y="0" width="56" height="13" forecolor="#000000" backcolor="#FFFFFF" uuid="769f042a-1e80-4050-ba7d-0a00d05c4915"/>
				<textElement textAlignment="Right" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="SansSerif" size="8" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{importe_2}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
